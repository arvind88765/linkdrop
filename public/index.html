<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LinkDrop â€” Private P2P Rooms</title>
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <meta name="theme-color" content="#0b0f14" />
</head>
<body class="page-home">
  <header class="topbar">
    <div class="brand">
      <div class="logo">ðŸ”—</div>
      <span>LinkDrop</span>
    </div>
    <button class="ghost-btn" onclick="openAbout()">About</button>
  </header>

  <main class="hero">
    <div class="hero__copy">
      <h1>Share privately, connect instantly.</h1>
      <p>Spin up a secure P2P room in seconds. No sign-ups. Your media flows device-to-device.</p>

      <div class="cta-row">
        <button class="btn btn-primary" onclick="createRoom()" aria-label="Create a new room">Create Room</button>
        <button class="btn" onclick="openJoin()" aria-label="Join a room by code">Join Room</button>
      </div>

      <div class="helper">
        <span class="kbd">Tip</span> Press <span class="kbd">C</span> to create, <span class="kbd">J</span> to join.
      </div>
    </div>

    <div class="hero__card">
      <div class="card">
        <h3>How it works</h3>
        <ol>
          <li>Create a room (auto-generates a 6-char code).</li>
          <li>Share the link/code with your peer.</li>
          <li>Approve the join request and chat P2P.</li>
        </ol>
        <div class="muted">Powered by WebRTC & Socket.IO signaling.</div>
      </div>
    </div>
  </main>

  <!-- Join Modal -->
  <dialog id="joinDialog" class="dialog">
    <form method="dialog" class="dialog__surface" onsubmit="return false;">
      <h3>Join a Room</h3>
      <label class="field">
        <span>Room code</span>
        <input id="joinCode" type="text" inputmode="latin-prose" autocomplete="one-time-code"
               placeholder="e.g. A1B2C3" maxlength="6" aria-label="Enter 6-character room code" />
      </label>
      <div class="dialog__actions">
        <button class="btn" onclick="closeJoin()">Cancel</button>
        <button class="btn btn-primary" onclick="submitJoin()">Join</button>
      </div>
    </form>
  </dialog>

  <!-- About Modal -->
  <dialog id="aboutDialog" class="dialog">
    <form method="dialog" class="dialog__surface">
      <h3>About LinkDrop</h3>
      <p>Peer-to-peer rooms with a single shareable link. No accounts, no fuss.</p>
      <div class="dialog__actions">
        <button class="btn btn-primary" onclick="closeAbout()">Close</button>
      </div>
    </form>
  </dialog>

  <script>
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key.toLowerCase() === 'c') createRoom();
      if (e.key.toLowerCase() === 'j') openJoin();
    });

    function randomCode() {
      return Math.random().toString(36).substr(2, 6).toUpperCase();
    }

    function createRoom() {
      const code = randomCode();
      window.location.href = `/room/${code}`;
    }

    const joinDialog = document.getElementById('joinDialog');
    const aboutDialog = document.getElementById('aboutDialog');

    function openJoin() {
      joinDialog.showModal();
      const input = document.getElementById('joinCode');
      input.value = '';
      setTimeout(() => input.focus(), 0);
    }
    function closeJoin() { joinDialog.close(); }

    function submitJoin() {
      const input = document.getElementById('joinCode');
      const code = (input.value || '').trim().toUpperCase();
      if (/^[A-Z0-9]{6}$/.test(code)) {
        window.location.href = `/room/${code}`;
      } else {
        input.setCustomValidity('Please enter a valid 6-character code (A-Z, 0-9).');
        input.reportValidity();
        setTimeout(() => input.setCustomValidity(''), 1200);
      }
    }

    function openAbout(){ aboutDialog.showModal(); }
    function closeAbout(){ aboutDialog.close(); }
  </script>
</body>
</html>
